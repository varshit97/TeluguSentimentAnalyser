<!DOCTYPE html>
<html>
	<head>
		<title>Sentimental Analyser</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	</head>
	<body>
		<h3>Enter the text below</h3>
		<script type="text/javascript" src="js/jquery-1.8.0.min.js"></script>
		<script type="text/javascript" src="js/jsapi"></script>
		<textarea id="transliterateTextarea" style="width:600px;height:200px">thopu</textarea>
		<br/>
		<input type="button" id="button" value="Compute Sentiment">
		<br/>
		<meter id="sentiment" value="0" min="-100" max="100">2 out of 10</meter>
		<br/>
		<input id="sButton" type="button" value="Show Sentiment">
		<script type="text/javascript" charset="utf-8">
			var sentiment = 0;
			$("#sentiment").val(0);
			var filling = 0;
			var value = 1;
			var interval = null;
			$("#button").click(function(){
				$("#sentiment").val(0);
				filling = 0;
				value = 1;
				interval = null;
				$.ajax({
				    url: "http://127.0.0.1:5000/sentiment", 
				    type: "POST",
				    contentType: "application/json",
				    data: JSON.stringify({'input': myFunc()}),
				    success: function(data){ 
						console.log(data['data']);
						sentiment = data['data'] * 100;
				    } 
				});
			});
			function myFunc(){
			  var val = document.getElementById('transliterateTextarea').value;
			  console.log(val);
			  return val;
			}
			function returnSentiment(){
				return sentiment;
			}
			if(sentiment >= 0){
				value = 1;
			}
			else{
				value = -1;	
			}
			function fillBar(){
				//console.log(sentiment, filling * 100, ' bye ', value);
				$("#sentiment").val((filling).toString());
				if(filling < sentiment && value > 0){
					filling += value * 2.4;
					console.log(value + ' ' + filling + " less");
				}
				if(filling > sentiment && value < 0){
					filling += value * 2.4;
					console.log(value + ' ' + filling + " less");
				}
				if(value > 0 && filling >= sentiment){
					clearInterval(interval);
				}
				if(value < 0 && filling <= sentiment){
					clearInterval(interval);
				}
			}
			$("#sButton").click(function(){
				interval = setInterval(fillBar, 100);
			});
			google.load("elements", "1", {
				packages: "transliteration"
			});
		    function onLoad() {
				var options = {
				    sourceLanguage:
				        [google.elements.transliteration.LanguageCode.ENGLISH],
				    destinationLanguage:
				        [google.elements.transliteration.LanguageCode.TELUGU],
				    shortcutKey: 'ctrl+g',
				    transliterationEnabled: true
				};
	
				var control = new google.elements.transliteration.TransliterationControl(options);
	
				control.makeTransliteratable(['transliterateTextarea']);
			}
			google.setOnLoadCallback(onLoad);
		</script>
	</body>
</html>
